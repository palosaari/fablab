
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.0">
    
    
      
        <title>7. Electronics design - Fab Lab Oulu Student Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#7-electronics-design" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Fab Lab Oulu Student Blog" class="md-header__button md-logo" aria-label="Fab Lab Oulu Student Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fab Lab Oulu Student Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              7. Electronics design
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Fab Lab Oulu Student Blog" class="md-nav__button md-logo" aria-label="Fab Lab Oulu Student Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Fab Lab Oulu Student Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About Me
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../finalproject/" class="md-nav__link">
        Final Project
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Assignments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Assignments" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week01/" class="md-nav__link">
        1. Principles and practices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week02/" class="md-nav__link">
        2. Project management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week03/" class="md-nav__link">
        3. Computer-Aided Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week04/" class="md-nav__link">
        4. Computer controlled cutting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week05/" class="md-nav__link">
        5. Invention, intellectual property and income
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week06/" class="md-nav__link">
        6. Electronics production
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          7. Electronics design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        7. Electronics design
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    Assignment
  </a>
  
    <nav class="md-nav" aria-label="Assignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#individual-assignment" class="md-nav__link">
    Individual assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-assignment" class="md-nav__link">
    Group assignment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kicad-6" class="md-nav__link">
    KiCad 6
  </a>
  
    <nav class="md-nav" aria-label="KiCad 6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kicad-installation" class="md-nav__link">
    KiCad installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kicad-fab-lab-settings" class="md-nav__link">
    KiCad Fab Lab settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attiny-412-board" class="md-nav__link">
    ATtiny 412 board
  </a>
  
    <nav class="md-nav" aria-label="ATtiny 412 board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mods-fails-to-generate-toolpath" class="md-nav__link">
    Mods fails to generate toolpath
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#different-pcb-mills" class="md-nav__link">
    Different PCB mills
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assembling-circuit-board-boards" class="md-nav__link">
    Assembling circuit board boards
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-board" class="md-nav__link">
    Testing the board
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observe-uart-data" class="md-nav__link">
    Observe UART data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-thoughts" class="md-nav__link">
    Final thoughts
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week08/" class="md-nav__link">
        8. Input devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week09/" class="md-nav__link">
        9. Output devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week10/" class="md-nav__link">
        10. Embedded programming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week11/" class="md-nav__link">
        11. Interface and application programming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week12/" class="md-nav__link">
        12. Applications and implications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week13/" class="md-nav__link">
        13. Networking and communications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week14/" class="md-nav__link">
        14. 3D Scanning and Printing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week15/" class="md-nav__link">
        15. Molding and Casting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week16/" class="md-nav__link">
        16. Computer Controlled Machining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week18/" class="md-nav__link">
        18. Mechanical Design (part 1 of 2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../week19/" class="md-nav__link">
        19. Machine Design (part 2 of 2)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    Assignment
  </a>
  
    <nav class="md-nav" aria-label="Assignment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#individual-assignment" class="md-nav__link">
    Individual assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-assignment" class="md-nav__link">
    Group assignment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kicad-6" class="md-nav__link">
    KiCad 6
  </a>
  
    <nav class="md-nav" aria-label="KiCad 6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kicad-installation" class="md-nav__link">
    KiCad installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kicad-fab-lab-settings" class="md-nav__link">
    KiCad Fab Lab settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attiny-412-board" class="md-nav__link">
    ATtiny 412 board
  </a>
  
    <nav class="md-nav" aria-label="ATtiny 412 board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mods-fails-to-generate-toolpath" class="md-nav__link">
    Mods fails to generate toolpath
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#different-pcb-mills" class="md-nav__link">
    Different PCB mills
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assembling-circuit-board-boards" class="md-nav__link">
    Assembling circuit board boards
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-board" class="md-nav__link">
    Testing the board
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observe-uart-data" class="md-nav__link">
    Observe UART data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-thoughts" class="md-nav__link">
    Final thoughts
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="7-electronics-design">7. Electronics design</h1>
<blockquote>
<h2 id="assignment">Assignment</h2>
<h3 id="individual-assignment">Individual assignment</h3>
<ul>
<li>redraw an echo hello-world board, add (at least) <ul>
<li>a button and LED (with current-limiting resistor)</li>
<li>check the design rules, make it, and test it</li>
<li>extra credit: simulate its operation</li>
</ul>
</li>
</ul>
<h3 id="group-assignment">Group assignment</h3>
<ul>
<li>use the test equipment in your lab to observe the operation of a micro-controller circuit board</li>
</ul>
</blockquote>
<h2 id="kicad-6">KiCad 6</h2>
<p>We used <a href="https://www.kicad.org/">KiCad</a> to design the electronics. Itâ€™s a widely used open source program and pretty good so there was no need to even evaluate at other options. I have previous experience in electronics design from years ago, but the program used was different and it has been so long since that anyway. </p>
<h3 id="kicad-installation">KiCad installation</h3>
<p><a href="https://www.kicad.org/blog/2021/12/KiCad-6.0.0-Release/">A version 6 of the KiCad</a> design suite is released recently, on 25th of December 2021. That version upgrade from 5 to 6 is a major change since earlier version was over 3 years old from year 2018. Our Fab Lab had the latest version installed and I wanted to install it on my workstation as well. I have a slightly old Fedora release 34 at my home workstation with only the older KiCad version 5 supported as native. Luckily, the newer version was easily available from the <a href="https://copr.fedorainfracloud.org/coprs/g/kicad/kicad/">Fedora Copr repository</a> so I installed it. <a href="https://www.kicad.org/download/fedora/">KiCad Install on Fedora</a>. </p>
<pre><code class="language-console">sudo dnf install dnf-plugins-core
sudo dnf copr enable @ kicad / kicad
sudo dnf install kicad
</code></pre>
<h3 id="kicad-fab-lab-settings">KiCad Fab Lab settings</h3>
<p><a href="https://gitlab.fabcloud.org/pub/libraries/electronics/kicad">Fab electronics component library for KiCad</a> contains all the official components that should be found in every Fab Lab. The components available in the library are easy to use in KiCad and you don't have to look for components elsewhere or design them yourself. There are a huge number of common components in the program anyway and you can use them as well, but then you have to take a closer look at the package of the component that it matches for component in Fab Lab, for example. </p>
<p>I followed the installation instructions for the Fab component library on my home computer and used the following settings: </p>
<pre><code class="language-console">$ cd ~/fablab/
$ git clone https://gitlab.fabcloud.org/pub/libraries/electronics/kicad.git
</code></pre>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/KiCad_Configure_Paths.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Configure Paths</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/KiCad_Footprint_Libraries.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Footprint Libraries</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/KiCad_Symbol_Libraries.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Symbol Libraries</td>
</tr>
</tbody>
</table>
<h2 id="attiny-412-board">ATtiny 412 board</h2>
<p>I did the standard echo hello device with button and led. First we looked Fab Academy board and made almost similar to it, having same micro-controller and UART connected to "FTDI" header, but added led and button too. Used micro-controller ATtiny 412 has very limited amount of I/O pins - only 6 - and even one of those is kinda reserved for the UPDI programmer. I connected LED between PA7 and VCC in series with 1k resistor to limit current. Button is connected between PA6 and ground having also 10k pull-up resistor to Vcc. Pull-up resistor is not mandatory, as I can understand the chip already has integrated pull-ups, that could be enabled by the software but anyhow now pull-up resistor is here still for sure. </p>
<p>BOM exported from KiCad.</p>
<table>
<thead>
<tr>
<th>References</th>
<th>Value</th>
<th>Footprint</th>
<th>Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td>C1</td>
<td>C</td>
<td>C_1206</td>
<td>1</td>
</tr>
<tr>
<td>R1</td>
<td>1k</td>
<td>R_1206</td>
<td>1</td>
</tr>
<tr>
<td>R2</td>
<td>10k</td>
<td>R_1206</td>
<td>1</td>
</tr>
<tr>
<td>D1</td>
<td>LED</td>
<td>LED_1206</td>
<td>1</td>
</tr>
<tr>
<td>U1</td>
<td>Microcontroller_ATtiny412_SSFR</td>
<td>SOIC-8_3.9x4.9mm_P1.27mm</td>
<td>1</td>
</tr>
<tr>
<td>SW1</td>
<td>BUTTON_B3SN</td>
<td>Button_Omron_B3SN_6x6mm</td>
<td>1</td>
</tr>
<tr>
<td>J1</td>
<td>Conn_PinHeader_FTDI_1x06_P2.54mm_Horizontal_SMD</td>
<td>PinHeader_FTDI_01x06_P2.54mm_Horizontal_SMD</td>
<td>1</td>
</tr>
<tr>
<td>J2</td>
<td>Conn_PinHeader_1x03_P2.54mm_Horizontal_SMD</td>
<td>PinHeader_1x03_P2.54mm_Horizontal_SMD</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>I forgot to add C1 value to design. 1uF was used.</p>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/components.resized.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>Components</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/EchoHelloLedButton_Schematic_Editor.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Schematic Editor</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/EchoHelloLedButton_PCB_Editor.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad PCB Editor</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/Board_Setup.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad PCB Editor - Board Setup used</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/KiCad_Export_SVG.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Export SVG for Roland MonoFab SRM-20</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/KiCad_Plot_Gerber.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>KiCad Plot Gerber for LPKF ProtoMat S62</td>
</tr>
</tbody>
</table>
<h3 id="mods-fails-to-generate-toolpath">Mods fails to generate toolpath</h3>
<p>I exported PCB as a vector two images from KiCad, one image for traces and  other image as board outline. After that I used <a href="https://mods.cba.mit.edu/">mods</a> tool to make toolpaths for Roland monoFab SRM-20 milling machine. At this point I had a lot of problems - I could not understand why my PCB borders were all the time wrong. I tried all relevant KiCad export settings very many times, tweaked with KiCad PCB borders (Edge Cuts layer) and some other layers but still it was always wrong and mods generated totally bad looking toolpaths which I sure didn't even want to test mill. Eventually I decided to open PCB borders file directly with my browser, Firefox, and saw the borders image were still rendered as badly as mods running on Firefox browser. At that point I started to suspect it might be an issue coused by the used browser and its svg-libraries. Then I decided to install Chromium browser (it is open source version of Google Chrome) as it was available on Fedora package management. That browser shows svg-file correctly, but then I ran other problem with mods when used Chromium browser - it fails to generate toolpath itself! Two steps forward and one step back :( After mods was find out to be broken with both Firefox and Chromium I started looking yet another browser. That browser was Google Chrome. I installed it from package available from vendor site. And finally it was a browser which works with mods on this single case at least. Too many compatibility issues - I have to say I am feeling mods is not best tool to mill PCB boards. </p>
<p>Here is pictures how simple PCB border in SVG format from KiCad is rendered on different applications. Firefox fails it badly. </p>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/svg_Firefox.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB borders .SVG on Firefox</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/svg_Chromium.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB borders .SVG on Chromium</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/svg_Google_Chrome.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB borders .SVG on Google Chrome</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/svg_Inkscape.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB borders .SVG on Inkscape</td>
</tr>
</tbody>
</table>
<h3 id="different-pcb-mills">Different PCB mills</h3>
<p>From KiCad PCB Editor I made both SVG-images and Gerber files of my PCB design. I made 2 PCBs using different milling machines, Roland MonoFab SRM-20 and LPKF ProtoMat S62. For Roland it was tricky to do PCB with that small traces as I used 0.4mm for Track Width and 0.25mm for Clearance. After two failed attempts I started adjusting trace milling depth from 0.05mm to 0.10mm by manual adjusting cut depth step by step deeper until it was fine. 0.2-0.5mm V-shaped milling bit was used. </p>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/roland_failed.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB v1 on Roland. It is bad.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/roland_succeed.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB v2 on Roland. It is OK.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/lpkf_succeed.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>PCB v2 on LPKF. It is OK.</td>
</tr>
</tbody>
</table>
<h3 id="assembling-circuit-board-boards">Assembling circuit board boards</h3>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/soldering.resized.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>Soldering</td>
</tr>
</tbody>
</table>
<p>I had milled two similar circuit boards with different milling machines as I wrote above. However, I assembled only one device and it was made on a circuit board made with an LPKF milling machine. Jani wanted one device to be made on a circuit board made with a Roland milling machine, because that milling machine is a milling machine according to the Fab Academy processes. </p>
<p>Fortunately, I still had a circuit board made with Roland in the spring, so I went to get the necessary components from the Fab Lab and made another similar device. I programmed and tested the device in the same way as the first one. Everything worked out without any problems. </p>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/boards.resized.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>Finished boards</td>
</tr>
</tbody>
</table>
<p>The bypass capacitor in the power supply seems to be physically a different size, and I'm not quite sure why. I have either accidentally installed a component of the wrong value on one of the two devices, or the Fab Lab has received new components to replace the ones that have run out, which are physically a little different in size. In any case, the value of the bypass capacitor is not critical and both devices are functional. </p>
<h3 id="testing-the-board">Testing the board</h3>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/testing.resized.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>Test setup</td>
</tr>
</tbody>
</table>
<p>I used Arduino IDE and Fab Academy <a href="http://academy.cba.mit.edu/classes/embedded_programming/t412/hello.t412.echo.ino">hello.t412.echo.ino</a> code to test it. </p>
<p>To test LED and button I make minor modifications to this Fab Academy hello echo program. </p>
<pre><code class="language-console">$ diff hello.t412.echo/hello.t412.echo.ino echo.hello.led.button.t412/echo.hello.led.button.t412.ino 
24a25,27
&gt; 
&gt;    pinMode(PIN_PA6, INPUT); // button
&gt;    pinMode(PIN_PA7, OUTPUT); // led
36a40,43
&gt; 
&gt;     // toggle led when button is pressed
&gt;     if (!digitalRead(PIN_PA6))
&gt;       digitalWrite(PIN_PA7, !digitalRead(PIN_PA7));
$ 
</code></pre>
<p>The button and LED works as expected. The microcontroller reads the state of the button in the loop at a very high frequency, so during a single physical press, it's status is read many, many times. Therefore, it is random which value happens to stay there, when the button is released. </p>
<p>Compiling:</p>
<pre><code class="language-console">Sketch uses 2020 bytes (49%) of program storage space. Maximum is 4096 bytes.
Global variables use 91 bytes (35%) of dynamic memory, leaving 165 bytes for local variables. Maximum is 256 bytes.
</code></pre>
<p>Programming:</p>
<pre><code class="language-console">SerialUPDI
UPDI programming for Arduino using a serial adapter
Based on pymcuprog, with significant modifications
By Quentin Bolsee and Spence Konde
Version 1.2.3 - Jan 2022
Using serial port /dev/ttyACM0 at 57600 baud.
Target: attiny412
Set fuses: ['2:0x02', '6:0x04', '8:0x00']
Action: write
File: /tmp/arduino_build_609485/echo.hello.led.button.t412.ino.hex
Pinging device...
Ping response: 1E9223
Setting fuse 0x2=0x2
Writing literal values...
Verifying literal values...
Action took 0.02s
Setting fuse 0x6=0x4
Writing literal values...
Verifying literal values...
Action took 0.02s
Setting fuse 0x8=0x0
Writing literal values...
Verifying literal values...
Action took 0.02s
Finished writing fuses.
Chip/Bulk erase,
Memory type eeprom is conditionally erased (depending upon EESAVE fuse setting)
Memory type flash is always erased
Memory type lockbits is always erased
...
Erased.
Action took 0.01s
Writing from hex file...
Writing flash...
[==================================================] 30/30
Action took 0.65s
Verifying...
[==================================================] 4/4
Verify successful. Data in flash matches data in specified hex-file
Action took 0.42s
</code></pre>
<p>Testing serial port:</p>
<pre><code class="language-console">$ python -m serial.tools.miniterm /dev/ttyUSB0 115200
--- Miniterm on /dev/ttyUSB0  115200,8,N,1 ---
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
hello.t412.echo: you typed &quot;F&quot;
hello.t412.echo: you typed &quot;Fa&quot;
hello.t412.echo: you typed &quot;Fab&quot;
hello.t412.echo: you typed &quot;Fab &quot;
hello.t412.echo: you typed &quot;Fab L&quot;
hello.t412.echo: you typed &quot;Fab La&quot;
hello.t412.echo: you typed &quot;Fab Lab&quot;
hello.t412.echo: you typed &quot;Fab Lab &quot;
hello.t412.echo: you typed &quot;Fab Lab O&quot;
hello.t412.echo: you typed &quot;Fab Lab Ou&quot;
hello.t412.echo: you typed &quot;Fab Lab Oul&quot;
hello.t412.echo: you typed &quot;Fab Lab Oulu&quot;

--- exit ---
$ 
</code></pre>
<h2 id="observe-uart-data">Observe UART data</h2>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/smartscope_dut.resized.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>Sniffing the UART signals with a logic analyzer</td>
</tr>
</tbody>
</table>
<p>I measured the signals from the device UART with LabNation SmartScope. The device has both an oscilloscope and a logic analyzer. </p>
<p>A UART is a slow digital bus with two data lines TX and RX, one for receiving data and the other for transmitting. There is no clock signal at all. Both the oscilloscope and the logic analyzer can measure the signal traveling on the bus, but from slightly different angles. An oscilloscope is more suitable for examining the waveform of a signal, while a logic analyzer is better suited for capturing and examining the data itself that travels on a bus. I connected the device's TX and RX lines using test clips to a logic analyzer and captured data from both buses. I turned the UART decoder on the analyzer and selected ASCII as the data format to be decoded because the device is sending text. This allowed me to easily check what text was transfered between the device and the computer. On that case it can be seen the board responds with a text: <strong>hello.t412.echo: you typed "Hello Fab Lab Oulu"</strong>. </p>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/smartscope_1.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>ATtiny 412 UART data</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/smartscope_2.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>UART pulse timings</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img alt="" src="../../images/week07/smartscope_3.resized.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>UART decoder settings</td>
</tr>
</tbody>
</table>
<h2 id="files">Files</h2>
<ul>
<li><a href="../../images/week07/EchoHelloLedButton.zip">EchoHelloLedButton.zip</a></li>
<li><a href="../../images/week07/EchoHelloLedButton-F_Cu.svg">EchoHelloLedButton-F_Cu.svg</a></li>
<li><a href="../../images/week07/EchoHelloLedButton-Edge_Cuts.svg">EchoHelloLedButton-Edge_Cuts.svg</a></li>
<li><a href="../../images/week07/traces.rml">traces.rml</a></li>
<li><a href="../../images/week07/outline.rml">outline.rml</a></li>
<li><a href="../../images/week07/echo.hello.led.button.t412.patch">echo.hello.led.button.t412.patch</a></li>
</ul>
<h2 id="final-thoughts">Final thoughts</h2>
<p>This week I learned the basics of KiCad and gained a lot more experience in PCB milling. I already knew the theory of electronics design at this level, though. </p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../week06/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 6. Electronics production" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              6. Electronics production
            </div>
          </div>
        </a>
      
      
        
        <a href="../week08/" class="md-footer__link md-footer__link--next" aria-label="Next: 8. Input devices" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              8. Input devices
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>